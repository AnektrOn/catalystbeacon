# ============================================================
# SETUP RAPIDE WEBHOOK STRIPE - RÃ‰SUMÃ‰
# ============================================================

# 1. ALLER DANS STRIPE DASHBOARD
#    https://dashboard.stripe.com â†’ Developers â†’ Webhooks â†’ Add endpoint

# 2. CONFIGURER L'ENDPOINT
#    URL: https://app.humancatalystbeacon.com/api/webhook
#    Ã‰vÃ©nements Ã  sÃ©lectionner:
#      âœ… checkout.session.completed
#      âœ… customer.subscription.created
#      âœ… customer.subscription.updated
#      âœ… customer.subscription.deleted
#      âœ… invoice.payment_succeeded
#      âœ… invoice.payment_failed
#      âœ… invoice.upcoming

# 3. COPIER LE SIGNING SECRET
#    Dans Stripe Dashboard â†’ Votre webhook â†’ Signing secret â†’ Reveal
#    Copiez le secret (commence par whsec_...)

# 4. AJOUTER DANS server.env
cd ~/domains/humancatalystbeacon.com/public_html/app
echo -n "Collez votre Stripe Webhook Secret (whsec_...): "
read WEBHOOK_SECRET
echo "STRIPE_WEBHOOK_SECRET=$WEBHOOK_SECRET" >> server.env

# 5. REDÃ‰MARRER PM2
pm2 restart hcuniversity-app --update-env
pm2 save

# 6. TESTER
#    Dans Stripe Dashboard â†’ Votre webhook â†’ Send test webhook
#    VÃ©rifiez les logs: pm2 logs hcuniversity-app

echo ""
echo "âœ… Configuration terminÃ©e!"
echo "ğŸ” VÃ©rifiez les logs: pm2 logs hcuniversity-app"
